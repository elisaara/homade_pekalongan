let laporan = '';

function reloadTable() {
    laporan.ajax.reload()
}

function remove(a) {
    Swal.fire({
        title: "Hapus",
        text: "Hapus data ini?",
        type: "warning",
        showCancelButton: !0
    }).then(() => {
        $.ajax({
            url: deleteUrl,
            type: "post",
            dataType: "json",
            data: {
                id: a
            },
            success: () => {
                Swal.fire("Sukses", "Sukses Menghapus Data", "success"), reloadTable()
            },
            error: a => {
                console.log(a)
            }
        })
    }, function(dismiss){
                console.log(dismiss)
    });
}

function getLaporan(e){
    console.log($(e).attr('data-laporan'))
    var lp = $(e).attr('data-laporan');
    var tanggal, bulan, start, end;
    switch(lp){
        case 'harian':
            tanggal = $('#tanggal').val();
        break;
        case 'bulanan':
            bulan = $('#bulan').val();
        break;
        case 'range':
            start = $('#start').val();
            end = $('#end').val();
        break;
    }
    $.ajax({
        url: getLaporanUrl,
        type: "post",
        dataType: "html",
        data: {
            laporan : lp
            , tanggal: tanggal
            , bulan: bulan
            , start: start
            , end: end
        },
        success: (result) => {
            $('.row-result').html('');
            $('.row-'+lp).html(result);
            $.each($('.row-'+lp+' table'),function(){
                $(this).DataTable({
                    responsive: !0,
                    scrollX: !0,
                });
            });
        },
        error: a => {
            console.log(a)
        }
    });
}


$("#tanggal").datetimepicker({
    format: "yyyy-mm-dd",
    weekStart: 1,
    todayBtn:  1,
    autoclose: 1,
    todayHighlight: 1,
    startView: 2,
    minView: 2,
    forceParse: 0
});
let now = moment().format("YYYY-MM-DD");
$("#tanggal").val(now);
$("#bulan").select2({
        placeholder: "Bulan"
    });

$('.input-daterange input').each(function() {

    let now = moment().format("YYYY-MM-DD");
    $(this).val(now);
    $(this).datetimepicker({
        format: "yyyy-mm-dd",
        weekStart: 1,
        todayBtn:  1,
        autoclose: 1,
        todayHighlight: 1,
        startView: 2,
        minView: 2,
        forceParse: 0
    });
});